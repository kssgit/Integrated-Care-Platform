global:
  nameOverride: ""
  fullnameOverride: ""
  namespace: integrated-care
  storageClass: ""
  security:
    allowInsecureImages: true

imagePullSecrets: []

serviceAccount:
  create: true
  name: ""
  annotations: {}
  automountServiceAccountToken: false

security:
  podSecurityContext:
    runAsNonRoot: true
    fsGroup: 10001
    seccompProfile:
      type: RuntimeDefault
  containerSecurityContext:
    runAsNonRoot: true
    runAsUser: 10001
    runAsGroup: 10001
    allowPrivilegeEscalation: false
    readOnlyRootFilesystem: false
    capabilities:
      drop:
        - ALL

networkPolicy:
  enabled: false
  allowSameNamespaceIngress: true
  allowDnsEgress: true
  egressAllowAll: true

scheduling:
  podAntiAffinity:
    enabled: true
    type: preferred
  topologySpread:
    enabled: true
    topologyKey: topology.kubernetes.io/zone
    maxSkew: 1
    whenUnsatisfiable: ScheduleAnyway

config:
  API_HOST: "0.0.0.0"
  API_PORT: "8000"
  API_CACHE_TTL_SECONDS: "30"
  API_EVENT_TOPIC: "api-events"
  API_EVENT_DLQ_TOPIC: "api-events-dlq"
  API_EVENT_PARKING_TOPIC: "api-events-parking"
  API_EVENT_CONSUMER_GROUP: "api-event-consumer"
  API_EVENT_CONSUMER_MAX_RETRIES: "3"
  API_EVENT_CONSUMER_BASE_DELAY_SECONDS: "0.1"
  API_EVENT_DEDUP_TTL_SECONDS: "3600"
  API_EVENT_DLQ_RETRY_GROUP: "api-event-dlq-retry"
  API_EVENT_DLQ_RETRY_MAX_ATTEMPTS: "3"
  API_EVENT_PARKING_MONITOR_GROUP: "api-event-parking-monitor"
  PARKING_ALERT_THRESHOLD: "10"
  PARKING_ALERT_WINDOW_SECONDS: "300"
  PARKING_ALERT_COOLDOWN_SECONDS: "300"
  PIPELINE_API_EVENT_PUBLISH_ENABLED: "false"
  PIPELINE_MONITORING_HOST: "0.0.0.0"
  PIPELINE_MONITORING_PORT: "8001"
  PIPELINE_STORE_BACKEND: "jsonl"
  PIPELINE_KAFKA_PUBLISH_ENABLED: "false"
  PIPELINE_PROVIDER_NAME: "seoul_open_data"
  PIPELINE_OUTPUT_FILE: "runtime/facilities.jsonl"
  PIPELINE_PAGE_SIZE: "200"
  PIPELINE_START_PAGE: "1"
  PIPELINE_END_PAGE: "1"
  AUTH_SERVICE_HOST: "0.0.0.0"
  AUTH_SERVICE_PORT: "8101"
  USER_SERVICE_HOST: "0.0.0.0"
  USER_SERVICE_PORT: "8102"
  FACILITY_SERVICE_HOST: "0.0.0.0"
  FACILITY_SERVICE_PORT: "8103"
  SEARCH_SERVICE_HOST: "0.0.0.0"
  SEARCH_SERVICE_PORT: "8104"
  ADMIN_SERVICE_HOST: "0.0.0.0"
  ADMIN_SERVICE_PORT: "8105"

secret:
  create: true
  REDIS_URL: ""
  DATABASE_URL: ""
  KAFKA_BOOTSTRAP_SERVERS: ""
  PARKING_ALERT_WEBHOOK_URL: ""
  FACILITY_PROVIDER_BASE_URL: "https://provider.example.com"
  JWT_SECRET_KEY: "change-me"
  ENCRYPTION_MASTER_KEY: "change-me"
  INTERNAL_EVENT_HMAC_SECRET: ""
  AIRFLOW_API_BASE_URL: ""
  AIRFLOW_API_USERNAME: ""
  AIRFLOW_API_PASSWORD: ""
  AIRFLOW_DAG_ID: "seoul_care_plus_daily_sync"

api:
  enabled: true
  replicaCount: 2
  image:
    repository: ghcr.io/example/integrated-care-api
    tag: latest
    pullPolicy: IfNotPresent
  service:
    type: ClusterIP
    port: 80
    targetPort: 8000
  resources:
    requests:
      cpu: "200m"
      memory: "256Mi"
    limits:
      cpu: "1"
      memory: "1Gi"
  hpa:
    enabled: true
    minReplicas: 2
    maxReplicas: 20
    averageCpuUtilization: 65
  pdb:
    enabled: true
    minAvailable: 1

authService:
  enabled: true
  replicaCount: 1
  image:
    repository: ghcr.io/example/integrated-care-auth-service
    tag: latest
    pullPolicy: IfNotPresent
  service:
    type: ClusterIP
    port: 8101
    targetPort: 8101
  resources:
    requests:
      cpu: "100m"
      memory: "128Mi"
    limits:
      cpu: "500m"
      memory: "512Mi"

userService:
  enabled: true
  replicaCount: 1
  image:
    repository: ghcr.io/example/integrated-care-user-service
    tag: latest
    pullPolicy: IfNotPresent
  service:
    type: ClusterIP
    port: 8102
    targetPort: 8102
  resources:
    requests:
      cpu: "100m"
      memory: "128Mi"
    limits:
      cpu: "500m"
      memory: "512Mi"

facilityService:
  enabled: true
  replicaCount: 1
  image:
    repository: ghcr.io/example/integrated-care-facility-service
    tag: latest
    pullPolicy: IfNotPresent
  service:
    type: ClusterIP
    port: 8103
    targetPort: 8103
  resources:
    requests:
      cpu: "100m"
      memory: "128Mi"
    limits:
      cpu: "500m"
      memory: "512Mi"

searchService:
  enabled: true
  replicaCount: 1
  image:
    repository: ghcr.io/example/integrated-care-search-service
    tag: latest
    pullPolicy: IfNotPresent
  service:
    type: ClusterIP
    port: 8104
    targetPort: 8104
  resources:
    requests:
      cpu: "100m"
      memory: "128Mi"
    limits:
      cpu: "500m"
      memory: "512Mi"

adminService:
  enabled: true
  replicaCount: 1
  image:
    repository: ghcr.io/example/integrated-care-admin-service
    tag: latest
    pullPolicy: IfNotPresent
  service:
    type: ClusterIP
    port: 8105
    targetPort: 8105
  resources:
    requests:
      cpu: "100m"
      memory: "128Mi"
    limits:
      cpu: "500m"
      memory: "512Mi"

apiEventConsumer:
  enabled: false
  replicaCount: 1
  image:
    repository: ghcr.io/example/integrated-care-api-event-consumer
    tag: latest
    pullPolicy: IfNotPresent
  resources:
    requests:
      cpu: "100m"
      memory: "128Mi"
    limits:
      cpu: "500m"
      memory: "512Mi"

apiEventDlqRetryWorker:
  enabled: false
  replicaCount: 1
  image:
    repository: ghcr.io/example/integrated-care-api-event-dlq-retry
    tag: latest
    pullPolicy: IfNotPresent
  resources:
    requests:
      cpu: "100m"
      memory: "128Mi"
    limits:
      cpu: "500m"
      memory: "512Mi"

apiEventParkingMonitorWorker:
  enabled: false
  replicaCount: 1
  image:
    repository: ghcr.io/example/integrated-care-api-event-parking-monitor
    tag: latest
    pullPolicy: IfNotPresent
  resources:
    requests:
      cpu: "100m"
      memory: "128Mi"
    limits:
      cpu: "500m"
      memory: "512Mi"

kafkaTopicProvisioner:
  enabled: true
  image:
    repository: bitnamilegacy/kafka
    tag: "3.9.0"
    pullPolicy: IfNotPresent
  auth:
    enabled: true
    securityProtocol: SASL_PLAINTEXT
    saslMechanism: PLAIN
    username: user1
    passwordSecretName: ""
    passwordSecretKey: client-passwords
  topics:
    - name: etl-raw-events
      partitions: 3
      replicationFactor: 1
    - name: etl-normalized
      partitions: 3
      replicationFactor: 1
    - name: etl-errors
      partitions: 3
      replicationFactor: 1
    - name: api-events
      partitions: 3
      replicationFactor: 1
    - name: api-events-dlq
      partitions: 3
      replicationFactor: 1
    - name: api-events-parking
      partitions: 3
      replicationFactor: 1
    - name: facility-events
      partitions: 3
      replicationFactor: 1
    - name: user-events
      partitions: 3
      replicationFactor: 1
    - name: auth-events
      partitions: 3
      replicationFactor: 1

pipelineMonitoring:
  enabled: true
  replicaCount: 1
  image:
    repository: ghcr.io/example/integrated-care-pipeline-monitoring
    tag: latest
    pullPolicy: IfNotPresent
  service:
    type: ClusterIP
    port: 80
    targetPort: 8001
  resources:
    requests:
      cpu: "100m"
      memory: "128Mi"
    limits:
      cpu: "500m"
      memory: "512Mi"
  pdb:
    enabled: false
    minAvailable: 1

etlCronJob:
  enabled: true
  schedule: "0 2 * * *"
  concurrencyPolicy: Forbid
  successfulJobsHistoryLimit: 2
  failedJobsHistoryLimit: 3
  image:
    repository: ghcr.io/example/integrated-care-pipeline-etl
    tag: latest
    pullPolicy: IfNotPresent
  resources:
    requests:
      cpu: "150m"
      memory: "256Mi"
    limits:
      cpu: "1"
      memory: "1Gi"

serviceMonitor:
  enabled: true
  interval: 15s

migrations:
  enabled: false
  backoffLimit: 2

ingress:
  enabled: false
  className: ""
  annotations: {}
  hosts:
    - host: integrated-care.local
      paths:
        - path: /
          pathType: Prefix
          serviceName: api
          servicePort: 80
  tls: []

dependencies:
  postgresql:
    enabled: false
  redis:
    enabled: true
  kafka:
    enabled: true
  kubePrometheusStack:
    enabled: false
  airflow:
    enabled: false

airflow:
  images:
    redis:
      repository: bitnamilegacy/redis
  workers:
    persistence:
      storageClassName: ""
  triggerer:
    persistence:
      storageClassName: ""
  logs:
    persistence:
      storageClassName: ""
  dags:
    persistence:
      storageClassName: ""
  redis:
    persistence:
      storageClassName: ""
  postgresql:
    primary:
      persistence:
        storageClass: ""
    image:
      registry: docker.io
      repository: bitnamilegacy/postgresql

postgresql:
  image:
    repository: bitnamilegacy/postgresql
  primary:
    persistence:
      storageClass: ""
    service:
      type: ClusterIP
      nodePorts:
        postgresql: ""
  auth:
    username: postgres
    password: postgres
    database: integrated_care

redis:
  image:
    repository: bitnamilegacy/redis
  master:
    persistence:
      storageClass: ""
  replica:
    persistence:
      storageClass: ""

kafka:
  image:
    repository: bitnamilegacy/kafka
  persistence:
    storageClass: ""
  controller:
    persistence:
      storageClass: ""
  broker:
    persistence:
      storageClass: ""
  provisioning:
    image:
      repository: bitnamilegacy/kafka
